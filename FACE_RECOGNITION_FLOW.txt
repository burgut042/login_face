================================================================================
                    FACE RECOGNITION - QAYERDA TURIBDI?
================================================================================

ğŸ“… Yaratilgan: 2025-12-19
ğŸ“ Fayl: emotion_app/views.py
ğŸ¯ Maqsad: Face tanish jarayonini tushuntirish


================================================================================
                    1. ASOSIY 3 TA FUNKSIYA
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£  load_known_faces_cached()  - Bazadagi yuzlarni yuklash               â”‚
â”‚    ğŸ“ Lines: 96-138                                                        â”‚
â”‚    ğŸ¯ Vazifa: Barcha Person'larning face encoding'ini cache'dan olish      â”‚
â”‚                                                                            â”‚
â”‚ 2ï¸âƒ£  recognize_face_fast()      - Yuzni tanish (asosiy algoritm)          â”‚
â”‚    ğŸ“ Lines: 141-209                                                       â”‚
â”‚    ğŸ¯ Vazifa: Kiritilgan rasmdan yuzni topib, bazadagi yuzlar bilan        â”‚
â”‚               solishtirish                                                 â”‚
â”‚                                                                            â”‚
â”‚ 3ï¸âƒ£  detect_face()              - API endpoint (HTTP)                     â”‚
â”‚    ğŸ“ Lines: 232-308                                                       â”‚
â”‚    ğŸ¯ Vazifa: Frontend'dan rasm qabul qilib, natijani qaytarish           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    2. TO'LIQ JARAYON (STEP-BY-STEP)
================================================================================

### QADĞĞœ 1: Frontend rasm yuboradi

POST /api/detect-face/
{
    "image": "data:image/jpeg;base64,/9j/4AAQSkZJRg..."
}

ğŸ“ Kod: views.py:233-248
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ @csrf_exempt                                        â”‚
    â”‚ def detect_face(request):                           â”‚
    â”‚     body = json.loads(request.body)                 â”‚
    â”‚     image_data = body.get("image", "")              â”‚
    â”‚     if "base64," in image_data:                     â”‚
    â”‚         image_data = image_data.split("base64,")[1] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### QADĞĞœ 2: Base64'ni rasmga aylantirish

ğŸ“ Kod: views.py:250-253
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # Base64 â†’ bytes â†’ numpy array â†’ OpenCV image      â”‚
    â”‚ image_bytes = base64.b64decode(image_data)          â”‚
    â”‚ nparr = np.frombuffer(image_bytes, np.uint8)        â”‚
    â”‚ frame = cv2.imdecode(nparr, cv2.IMREAD_COLOR)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Natija: frame - OpenCV rasmi (numpy array)


### QADĞĞœ 3: recognize_face_fast() chaqirish

ğŸ“ Kod: views.py:260
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ recognition_result = recognize_face_fast(frame)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Bu funksiya ichida 7 ta bosqich bor â†“


### QADĞĞœ 3.1: Ma'lum yuzlarni yuklash

ğŸ“ Kod: views.py:149
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ known_encodings, known_persons =                    â”‚
    â”‚     load_known_faces_cached()                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

load_known_faces_cached() ichida:
    ğŸ“ Lines: 96-138

    1. Cache'dan tekshirish (lines 100-104)
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ cache_key = "known_faces_data"               â”‚
       â”‚ cached_data = cache.get(cache_key)           â”‚
       â”‚ if cached_data:                              â”‚
       â”‚     return cached_data["encodings"], ...     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    2. Bazadan Person'larni olish (lines 106-130)
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ persons = Person.objects.all()               â”‚
       â”‚ for person in persons:                       â”‚
       â”‚     if person.face_encoding:                 â”‚
       â”‚         # Mavjud encoding'ni olish           â”‚
       â”‚         enc = np.array(person.face_encoding) â”‚
       â”‚         known_encodings.append(enc)          â”‚
       â”‚     elif person.photo:                       â”‚
       â”‚         # Rasmdan encoding yaratish           â”‚
       â”‚         image = face_recognition.load_image_â”‚
       â”‚                 file(person.photo.path)       â”‚
       â”‚         encodings = face_recognition.        â”‚
       â”‚                     face_encodings(image)    â”‚
       â”‚         known_encodings.append(encodings[0]) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    3. Cache'ga saqlash (lines 132-136)
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ cache.set(                                   â”‚
       â”‚     cache_key,                               â”‚
       â”‚     {"encodings": ..., "persons": ...},      â”‚
       â”‚     timeout=3600  # 1 soat                   â”‚
       â”‚ )                                            â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### QADĞĞœ 3.2: Rasmni kichraytirish (optimization)

ğŸ“ Kod: views.py:154-155
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # Rasmni 75% ga kichraytirish (tezlik uchun)       â”‚
    â”‚ small_frame = cv2.resize(frame, (0, 0),             â”‚
    â”‚                          fx=0.75, fy=0.75)          â”‚
    â”‚ rgb_frame = cv2.cvtColor(small_frame,               â”‚
    â”‚                          cv2.COLOR_BGR2RGB)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### QADĞĞœ 3.3: Yuz joylashuvini topish

ğŸ“ Kod: views.py:157-161
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # face_recognition kutubxonasi bilan yuz topish     â”‚
    â”‚ face_locations = face_recognition.face_locations(   â”‚
    â”‚     rgb_frame,                                      â”‚
    â”‚     model="hog",          # HOG algoritmi           â”‚
    â”‚     number_of_times_to_upsample=1                   â”‚
    â”‚ )                                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Natija: [(top, right, bottom, left), ...]
        Masalan: [(120, 320, 280, 160)]


### QADĞĞœ 3.4: Face encoding yaratish

ğŸ“ Kod: views.py:166-171
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # Topilgan yuzdan 128 o'lchamli vektor yaratish     â”‚
    â”‚ face_encodings = face_recognition.face_encodings(   â”‚
    â”‚     rgb_frame,                                      â”‚
    â”‚     face_locations                                  â”‚
    â”‚ )                                                   â”‚
    â”‚ face_encoding = face_encodings[0]  # Birinchi yuz  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Natija: 128 o'lchamli numpy array
        [0.123, -0.456, 0.789, ..., 0.321]


### QADĞĞœ 3.5: Bazadagi yuzlar bilan solishtirish

ğŸ“ Kod: views.py:173-176
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # Har bir ma'lum yuz bilan taqqoslash               â”‚
    â”‚ matches = face_recognition.compare_faces(           â”‚
    â”‚     known_encodings,    # Bazadagi yuzlar           â”‚
    â”‚     face_encoding,      # Kiritilgan yuz            â”‚
    â”‚     tolerance=0.5       # O'xshashlik chegarasi     â”‚
    â”‚ )                                                   â”‚
    â”‚ face_distances = face_recognition.face_distance(    â”‚
    â”‚     known_encodings,                                â”‚
    â”‚     face_encoding                                   â”‚
    â”‚ )                                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Natija:
    matches = [False, True, False, True, ...]
    face_distances = [0.8, 0.3, 0.9, 0.2, ...]

Distance ma'nosi:
    0.0 = 100% o'xshash
    1.0 = 0% o'xshash
    0.5 = chegara (tolerance)


### QADĞĞœ 3.6: Eng yaxshi moslikni topish

ğŸ“ Kod: views.py:181-195
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ # Eng kichik distance'ni topish                     â”‚
    â”‚ best_match_idx = int(np.argmin(face_distances))     â”‚
    â”‚                                                     â”‚
    â”‚ if matches[best_match_idx]:                         â”‚
    â”‚     distance = float(face_distances[best_match_idx])â”‚
    â”‚     confidence = (1.0 - distance) * 100.0           â”‚
    â”‚                                                     â”‚
    â”‚     if confidence < 50.0:                           â”‚
    â”‚         return PersonRecognitionResult()            â”‚
    â”‚                                                     â”‚
    â”‚     person = known_persons[best_match_idx]          â”‚
    â”‚     return PersonRecognitionResult(                 â”‚
    â”‚         person=person,                              â”‚
    â”‚         confidence=confidence                       â”‚
    â”‚     )                                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Misol:
    distance = 0.25
    confidence = (1.0 - 0.25) * 100 = 75%


### QADĞĞœ 4: Natijani qaytarish

ğŸ“ Kod: views.py:262-292
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ if not recognition_result.is_registered:            â”‚
    â”‚     # Shaxs tanilmadi                               â”‚
    â”‚     return JsonResponse({                           â”‚
    â”‚         "person": {"is_registered": False, ...}     â”‚
    â”‚     })                                              â”‚
    â”‚                                                     â”‚
    â”‚ # Shaxs tanildi                                     â”‚
    â”‚ person = recognition_result.person                  â”‚
    â”‚ confidence = recognition_result.confidence          â”‚
    â”‚                                                     â”‚
    â”‚ return JsonResponse({                               â”‚
    â”‚     "success": True,                                â”‚
    â”‚     "person": {                                     â”‚
    â”‚         "id": person.id,                            â”‚
    â”‚         "full_name": person.full_name,              â”‚
    â”‚         "confidence": round(confidence, 2),         â”‚
    â”‚         ...                                         â”‚
    â”‚     }                                               â”‚
    â”‚ })                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    3. DIAGRAM - TO'LIQ JARAYON
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FRONTEND                                      â”‚
â”‚  webcam â†’ base64 image â†’ POST /api/detect-face/                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     detect_face() - Line 233                            â”‚
â”‚  1. JSON parse                                                          â”‚
â”‚  2. Base64 decode                                                       â”‚
â”‚  3. OpenCV image yaratish                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  recognize_face_fast() - Line 141                       â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ load_known_faces_cached() - Line 96                             â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚ Cache'dan tekshirish                                   â”‚     â”‚  â”‚
â”‚  â”‚  â”‚ âœ“ Mavjud â†’ Qaytarish                                   â”‚     â”‚  â”‚
â”‚  â”‚  â”‚ âœ— Yo'q â†’ Database'dan olish                            â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚ Person.objects.all() â†’ For loop                        â”‚     â”‚  â”‚
â”‚  â”‚  â”‚                                                         â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  âœ“ face_encoding mavjud â†’ Use it                       â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  âœ— photo mavjud â†’ Create encoding                      â”‚     â”‚  â”‚
â”‚  â”‚  â”‚      - face_recognition.load_image_file()              â”‚     â”‚  â”‚
â”‚  â”‚  â”‚      - face_recognition.face_encodings()               â”‚     â”‚  â”‚
â”‚  â”‚  â”‚      - Save to database                                â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  Return: known_encodings, known_persons                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Rasmni tayyorlash                                                â”‚  â”‚
â”‚  â”‚  - cv2.resize() - 75% ga kichraytirish                           â”‚  â”‚
â”‚  â”‚  - cv2.cvtColor() - BGR â†’ RGB                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Yuz topish                                                       â”‚  â”‚
â”‚  â”‚  face_recognition.face_locations(rgb_frame, model="hog")         â”‚  â”‚
â”‚  â”‚  Return: [(top, right, bottom, left), ...]                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Face encoding yaratish                                           â”‚  â”‚
â”‚  â”‚  face_recognition.face_encodings(rgb_frame, face_locations)      â”‚  â”‚
â”‚  â”‚  Return: [128-dimensional vector]                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Taqqoslash                                                       â”‚  â”‚
â”‚  â”‚  face_recognition.compare_faces(known_encodings, face_encoding)  â”‚  â”‚
â”‚  â”‚  face_recognition.face_distance(known_encodings, face_encoding)  â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  matches = [False, True, False, ...]                            â”‚  â”‚
â”‚  â”‚  distances = [0.8, 0.3, 0.9, ...]                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Eng yaxshi moslikni topish                                       â”‚  â”‚
â”‚  â”‚  best_idx = np.argmin(distances)                                 â”‚  â”‚
â”‚  â”‚  confidence = (1.0 - distance) * 100                             â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  âœ“ confidence >= 50% â†’ Person topildi                           â”‚  â”‚
â”‚  â”‚  âœ— confidence < 50% â†’ Tanilmadi                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  Return: PersonRecognitionResult(person, confidence)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     detect_face() - Line 262                            â”‚
â”‚  Natijani tekshirish va JSON qaytarish                                 â”‚
â”‚                                                                         â”‚
â”‚  âœ“ Tanildi â†’ { success: true, person: {...}, confidence: 75.5 }        â”‚
â”‚  âœ— Tanilmadi â†’ { person: { is_registered: false } }                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FRONTEND                                      â”‚
â”‚  Response'ni qabul qilish â†’ UI'da ko'rsatish                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    4. MUHIM LINE NUMBERS
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Funksiya                           â”‚ Line Numbers â”‚ Vazifa                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ load_known_faces_cached()          â”‚ 96-138       â”‚ Bazadan yuzlar yuklash â”‚
â”‚   â†’ Cache check                    â”‚ 100-104      â”‚ Cache'dan olish        â”‚
â”‚   â†’ Database query                 â”‚ 106          â”‚ Person.objects.all()   â”‚
â”‚   â†’ Encoding check                 â”‚ 112-116      â”‚ Mavjud encoding        â”‚
â”‚   â†’ Create encoding                â”‚ 118-127      â”‚ Rasmdan yaratish       â”‚
â”‚   â†’ Cache save                     â”‚ 132-136      â”‚ Cache'ga saqlash       â”‚
â”‚                                    â”‚              â”‚                        â”‚
â”‚ recognize_face_fast()              â”‚ 141-209      â”‚ Yuzni tanish           â”‚
â”‚   â†’ Load known faces               â”‚ 149          â”‚ Cache'dan yuklash      â”‚
â”‚   â†’ Resize image                   â”‚ 154-155      â”‚ Optimizatsiya          â”‚
â”‚   â†’ Find face locations            â”‚ 157-161      â”‚ Yuz topish (HOG)       â”‚
â”‚   â†’ Create face encoding           â”‚ 166          â”‚ 128-D vektor           â”‚
â”‚   â†’ Compare faces                  â”‚ 173-176      â”‚ Taqqoslash             â”‚
â”‚   â†’ Find best match                â”‚ 181-195      â”‚ Eng yaxshisini topish  â”‚
â”‚                                    â”‚              â”‚                        â”‚
â”‚ detect_face()                      â”‚ 232-308      â”‚ API endpoint           â”‚
â”‚   â†’ Parse JSON                     â”‚ 241-242      â”‚ Request body           â”‚
â”‚   â†’ Decode Base64                  â”‚ 247-253      â”‚ Image decode           â”‚
â”‚   â†’ Call recognize_face_fast()     â”‚ 260          â”‚ Tanish                 â”‚
â”‚   â†’ Build response                 â”‚ 262-292      â”‚ JSON response          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    5. FACE RECOGNITION LIBRARY CALLS
================================================================================

Sistema quyidagi face_recognition funksiyalarini ishlatadi:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Funksiya                               â”‚ Line     â”‚ Vazifa                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ face_recognition.load_image_file()     â”‚ 119      â”‚ Rasmni yuklash          â”‚
â”‚ face_recognition.face_encodings()      â”‚ 120, 166 â”‚ Encoding yaratish       â”‚
â”‚ face_recognition.face_locations()      â”‚ 157      â”‚ Yuz joylashuvini topish â”‚
â”‚ face_recognition.compare_faces()       â”‚ 173      â”‚ Yuzlarni solishtirish   â”‚
â”‚ face_recognition.face_distance()       â”‚ 176      â”‚ Distance hisoblash      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    6. PERFORMANCE OPTIMIZATION
================================================================================

### Cache (1 soat)
ğŸ“ Line 100-104, 132-136
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ cache_key = "known_faces_data"                   â”‚
    â”‚ timeout = 3600  # 1 soat                         â”‚
    â”‚                                                  â”‚
    â”‚ âœ… Har safar database'ga murojaat qilmaydi       â”‚
    â”‚ âœ… Face encoding bir marta yaratiladi            â”‚
    â”‚ âœ… Tezlik 10x oshadi                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### Image resizing (75%)
ğŸ“ Line 154-155
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ small_frame = cv2.resize(frame, (0, 0),          â”‚
    â”‚                          fx=0.75, fy=0.75)       â”‚
    â”‚                                                  â”‚
    â”‚ âœ… Rasm hajmi 56% ga kamayadi                    â”‚
    â”‚ âœ… Processing tezligi 2x oshadi                  â”‚
    â”‚ âœ… Aniqlik kam ta'sirlanadi                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### HOG model (CNN emas)
ğŸ“ Line 159
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ model="hog"  # CNN emas                          â”‚
    â”‚                                                  â”‚
    â”‚ âœ… Tezroq (CPU'da)                               â”‚
    â”‚ âœ… Aniqlik yetarli (90%+)                        â”‚
    â”‚ âŒ CNN aniqroq lekin sekinroq                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                    7. PARAMETRLAR
================================================================================

### Tolerance (chegara)
ğŸ“ Line 174
    tolerance=0.5

    0.0 = Juda qattiq (100% o'xshash bo'lishi kerak)
    0.5 = O'rtacha (tavsiya etiladi) â­
    1.0 = Juda yumshoq (har kimni taniydi)

### Confidence threshold (minimal ishonch)
ğŸ“ Line 187
    if confidence < 50.0:
        return PersonRecognitionResult()  # Tanilmadi

    50% dan past â†’ Tanilmadi
    50-70% â†’ Past ishonch
    70-85% â†’ O'rtacha ishonch â­
    85-100% â†’ Yuqori ishonch


================================================================================
                    XULOSA
================================================================================

Face aniqlash 3 bosqichda ishlaydi:

1ï¸âƒ£  YUKLASH (load_known_faces_cached)
    ğŸ“ Lines 96-138
    - Bazadagi barcha yuzlarni cache'ga yuklash
    - 1 soatda bir marta yangilanadi

2ï¸âƒ£  TANISH (recognize_face_fast)
    ğŸ“ Lines 141-209
    - Rasmdan yuz topish
    - Face encoding yaratish
    - Bazadagi yuzlar bilan taqqoslash
    - Eng yaxshi moslikni topish

3ï¸âƒ£  QAYTARISH (detect_face)
    ğŸ“ Lines 232-308
    - API endpoint
    - Base64 â†’ OpenCV image
    - recognize_face_fast() chaqirish
    - JSON response yaratish

ASOSIY ALGORITM: lines 141-209 (recognize_face_fast)

OMAD! ğŸš€
